# MEMORY MANAGEMENT
shared_buffers = 2GB                 # Amount of memory PostgreSQL uses for caching
effective_cache_size = 6GB            # Assume available OS cache memory for queries
work_mem = 16MB                       # Memory per query (adjust for complex queries)
maintenance_work_mem = 512MB           # Memory for maintenance tasks (VACUUM, ALTER TABLE)

# CONNECTION MANAGEMENT
max_connections = 200                 # Number of concurrent connections allowed
superuser_reserved_connections = 5    # Keep a few reserved for superusers
idle_in_transaction_session_timeout = 60000  # Terminate idle transactions after 1 min

# DISK I/O & WRITE PERFORMANCE
fsync = on                            # Ensure transaction durability
synchronous_commit = off              # Improve performance (safely disable for analytics)
wal_level = minimal                   # Reduce WAL logs in non-replicated setups
checkpoint_timeout = 10min             # Frequency of WAL checkpoints
checkpoint_completion_target = 0.9     # Spread checkpoints to reduce disk spikes
random_page_cost = 1.1                 # Adjust for SSD-based storage

# QUERY PERFORMANCE
effective_io_concurrency = 200         # Optimize for parallelism on modern SSDs
parallel_tuple_cost = 0.1              # Reduce cost of parallel processing
parallel_setup_cost = 1000             # Control when parallelism is worth it
default_statistics_target = 100        # Improves query planner decisions
jit = on                               # Enable Just-In-Time compilation for queries

# LOGGING & MONITORING
log_statement = 'ddl'                  # Log only DDL (schema changes)
log_min_duration_statement = 1000       # Log queries taking longer than 1s
log_checkpoints = on                    # Log checkpoint activity
log_connections = on                    # Log successful connections
log_disconnections = on                 # Log when connections close
